<div class="container items-center px-4 py-8 m-auto mt-5">
    <div class="flex flex-wrap pb-3 mx-4 md:mx-24 lg:mx-0">
        <div class="w-full p-2 lg:w-1/4 md:w-1/2">
            <div class="flex flex-col px-6 py-10 overflow-hidden bg-white hover:bg-gradient-to-br hover:from-purple-400 hover:via-blue-400 hover:to-blue-500 rounded-xl shadow-lg duration-300 hover:shadow-2xl group">
                <div class="flex flex-row justify-between items-center">
                    <div class="px-4 py-4 bg-gray-300  rounded-xl bg-opacity-30">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 group-hover:text-gray-50" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="inline-flex text-sm text-gray-600 group-hover:text-gray-200 sm:text-base">
                        <button class="btn show-modal btn-ghost" onclick="my_modal_4.showModal()">Detail</button>
                    </div>
                </div>
                <h1 id="totalBook" class="text-3xl sm:text-4xl xl:text-5xl font-bold text-gray-700 mt-12 group-hover:text-gray-50"></h1>
                <div class="flex flex-row justify-between group-hover:text-gray-200">
                    <p>Jumlah Buku Dosen</p>
                </div>
            </div>
        </div>
        <div class="w-full p-2 lg:w-1/4 md:w-1/2">
            <div class="flex flex-col px-6 py-10 overflow-hidden bg-white hover:bg-gradient-to-br hover:from-purple-400 hover:via-blue-400 hover:to-blue-500 rounded-xl shadow-lg duration-300 hover:shadow-2xl group">
                <div class="flex flex-row justify-between items-center">
                    <div class="px-4 py-4 bg-gray-300  rounded-xl bg-opacity-30">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 group-hover:text-gray-50" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="inline-flex text-sm text-gray-600 group-hover:text-gray-200 sm:text-base">
                        <button class="btn show-modal btn-ghost" onclick="my_modal_2.showModal()">Detail</button>
                    </div>
                </div>
                <h1 id="totalCitationCount" class="text-3xl sm:text-4xl xl:text-5xl font-bold text-gray-700 mt-12 group-hover:text-gray-50"></h1>
                <div class="flex flex-row justify-between group-hover:text-gray-200">
                    <p>Jumlah Sitasi</p>
                </div>
            </div>
        </div>
        <div class="w-full p-2 lg:w-1/4 md:w-1/2">
            <div class="flex flex-col px-6 py-10 overflow-hidden bg-white hover:bg-gradient-to-br hover:from-purple-400 hover:via-blue-400 hover:to-blue-500 rounded-xl shadow-lg duration-300 hover:shadow-2xl group">
                <div class="flex flex-row justify-between items-center">
                    <div class="px-4 py-4 bg-gray-300  rounded-xl bg-opacity-30">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 group-hover:text-gray-50" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="inline-flex text-sm text-gray-600 group-hover:text-gray-200 sm:text-base">
                        <button class="btn show-modal btn-ghost" onclick="my_modal_5.showModal()">Detail</button>
                    </div>
                </div>
                <h1 id="totalISSNJournal" class="text-3xl sm:text-4xl xl:text-5xl font-bold text-gray-700 mt-12 group-hover:text-gray-50"></h1>
                <div class="flex flex-row justify-between group-hover:text-gray-200">
                    <p>Jumlah Artikel ISSN</p>
                </div>
            </div>
        </div>
        <div class="w-full p-2 lg:w-1/4 md:w-1/2">
            <div class="flex flex-col px-6 py-10 overflow-hidden bg-white hover:bg-gradient-to-br hover:from-purple-400 hover:via-blue-400 hover:to-blue-500 rounded-xl shadow-lg duration-300 hover:shadow-2xl group">
                <div class="flex flex-row justify-between items-center">
                    <div class="px-4 py-4 bg-gray-300  rounded-xl bg-opacity-30">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 group-hover:text-gray-50" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z" />
                            <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="inline-flex text-sm text-gray-600 group-hover:text-gray-200 sm:text-base">
                        <button class="btn btn-ghost" onclick="my_modal_3.showModal()">Detail</button>
                    </div>
                </div>
                <h1 id="totalInternationalJournal" class="text-3xl sm:text-4xl xl:text-5xl font-bold text-gray-700 mt-12 group-hover:text-gray-50"></h1>
                <div class="flex flex-row justify-between group-hover:text-gray-200">
                    <p>Jumlah Publikasi Internasional</p>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- modal jumlah sitasi per dosen -->
<dialog id="my_modal_2" class="modal modal-bottom sm:modal-middle">
    <div class="modal-box">
        <h3 class="font-bold text-lg">Detail Jumlah Data Sitasi Google Scholar</h3>
        <!-- datatable -->
        <div class="px-5 mt-5 overflow-x" style="max-width: 100vw; overflow-x: auto;">
            <table id="tabelSitasi" class="display" style="width: 100%;">
                <thead>
                    <tr class="text-sm md:text-xs">
                        <th>No</th>
                        <th>Judul</th>
                        <th>Nama Dosen</th>
                        <th>Jumlah Sitasi</th>
                    </tr>
                </thead>

                <tbody>
                    <script>
                        $(document).ready(function() {

                            // Declare table variable outside the DataTable initialization
                            var table;

                            table = $('#tabelSitasi').DataTable({
                                "dom": 'lfBrtip',
                                "fixedHeader": true,
                                "responsive": true,
                                "buttons": [{
                                    "extend": 'excel',
                                    "text": '<div class="download-excel"><button class="btn btn-outline  my-5">Download Excel</button></div>',
                                    "titleAttr": 'Excel',
                                    "action": newexportaction
                                }, ],
                                "processing": true,
                                "serverSide": true,
                                "pageLength": 10,
                                "lengthMenu": [10, 25, 50, 75, 100],
                                "ajax": {
                                    "url": "/dashboard/getCitedCountGscholar",
                                    "type": "post",
                                    "datatype": "json"
                                },
                                columns: [{
                                        data: "id",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "title",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "fullname",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "citation",
                                        class: 'responsive'
                                    },
                                ]
                            });

                        });
                    </script>
                </tbody>
            </table>
        </div>
        <!-- end datatable -->
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<!-- modal jumlah jurnal internasional dosen -->
<dialog id="my_modal_3" class="modal modal-bottom sm:modal-middle">
    <div class="modal-box">
        <h3 class="font-bold text-lg">Detail Jumlah Publikasi Internasional (Wos & Scopus)</h3>
        <!-- datatable -->
        <div class="px-5 mt-5 overflow-x" style="max-width: 100vw; overflow-x: auto;">
            <table id="tabelPublikasiInter" class="display" style="width: 100%;">
                <thead>
                    <tr class="text-sm md:text-xs">
                        <th>No</th>
                        <th>Nama Dosen</th>
                        <th>Jumlah</th>
                    </tr>
                </thead>

                <tbody>
                    <script>
                        $(document).ready(function() {

                            // Declare table variable outside the DataTable initialization
                            var table;

                            table = $('#tabelPublikasiInter').DataTable({
                                "dom": 'lfBrtip',
                                "fixedHeader": true,
                                "responsive": true,
                                "buttons": [{
                                    "extend": 'excel',
                                    "text": '<div class="download-excel"><button class="btn btn-outline  my-5">Download Excel</button></div>',
                                    "titleAttr": 'Excel',
                                    "action": newexportaction
                                }, ],
                                "processing": true,
                                "serverSide": true,
                                "pageLength": 10,
                                "lengthMenu": [10, 25, 50, 75, 100],
                                "ajax": {
                                    "url": "/dashboard/getCountInternationalJournal",
                                    "type": "post",
                                    "datatype": "json"
                                },
                                columns: [{
                                        data: "id",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "dosen_name",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "total_publikasi_internasional",
                                        class: 'responsive'
                                    },
                                ]
                            });

                        });
                    </script>
                </tbody>
            </table>
        </div>
        <!-- end datatable -->
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<!-- modal jumlah jurnal buku dosen -->
<dialog id="my_modal_4" class="modal modal-bottom sm:modal-middle">
    <div class="modal-box">
        <h3 class="font-bold text-lg">Detail Jumlah Buku Per Dosen</h3>
        <!-- datatable -->
        <div class="px-5 mt-5 overflow-x" style="max-width: 100vw; overflow-x: auto;">
            <table id="tableBook" class="display" style="width: 100%;">
                <thead>
                    <tr class="text-sm md:text-xs">
                        <th>No</th>
                        <th>Nama Dosen</th>
                        <th>Jumlah</th>
                    </tr>
                </thead>

                <tbody>
                    <script>
                        $(document).ready(function() {

                            // Declare table variable outside the DataTable initialization
                            var table;

                            table = $('#tableBook').DataTable({
                                "dom": 'lfBrtip',
                                "fixedHeader": true,
                                "responsive": true,
                                "buttons": [{
                                    "extend": 'excel',
                                    "text": '<div class="download-excel"><button class="btn btn-outline  my-5">Download Excel</button></div>',
                                    "titleAttr": 'Excel',
                                    "action": newexportaction
                                }, ],
                                "processing": true,
                                "serverSide": true,
                                "pageLength": 10,
                                "lengthMenu": [10, 25, 50, 75, 100],
                                "ajax": {
                                    "url": "/dashboard/getCountBookByLecture",
                                    "type": "post",
                                    "datatype": "json"
                                },
                                columns: [{
                                        data: "id",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "fullname",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "total_document",
                                        class: 'responsive'
                                    },
                                ]
                            });

                        });
                    </script>
                </tbody>
            </table>
        </div>
        <!-- end datatable -->
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>

<dialog id="my_modal_5" class="modal modal-bottom sm:modal-middle">
    <div class="modal-box">
        <h3 class="font-bold text-lg">Detail Jurnal Internasional Ber ISSN</h3>
        <!-- datatable -->
        <div class="px-5 mt-5 overflow-x" style="max-width: 100vw; overflow-x: auto;">
            <table id="tableISSN" class="display" style="width: 100%;">
                <thead>
                    <tr class="text-sm md:text-xs">
                        <th>No</th>
                        <th>Judul</th>
                    </tr>
                </thead>

                <tbody>
                    <script>
                        $(document).ready(function() {

                            // Declare table variable outside the DataTable initialization
                            var table;

                            table = $('#tableISSN').DataTable({
                                "dom": 'lfBrtip',
                                "responsive": true,
                                "fixedHeader": true,
                                "buttons": [{
                                    "extend": 'excel',
                                    "text": '<div class="download-excel"><button class="btn btn-outline  my-5">Download Excel</button></div>',
                                    "titleAttr": 'Excel',
                                    "action": newexportaction
                                }, ],
                                "processing": true,
                                "serverSide": true,
                                "pageLength": 10,
                                "lengthMenu": [10, 25, 50, 75, 100],
                                "ajax": {
                                    "url": "/dashboard/getAllISSNJournal",
                                    "type": "post",
                                    "datatype": "json"
                                },
                                columns: [{
                                        data: "id",
                                        class: 'responsive'
                                    },
                                    {
                                        data: "title",
                                        class: 'responsive'
                                    },
                                ]
                            });

                        });
                    </script>
                </tbody>
            </table>
        </div>
        <!-- end datatable -->
    </div>
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
</dialog>



<script src="<?= BASEURL; ?>/js/exportExcel.js"></script>
<script>
    $(document).ready(function() {
        const loadingSpinnerClass = 'loading loading-spinner loading-lg'

        // Ajax call to get total citation count
        $('#totalCitationCount').addClass(loadingSpinnerClass);
        $.ajax({
            url: 'dashboard/getTotalCitedCountGscholar',
            method: 'GET',
            dataType: 'json',
            success: function(response) {
                // Update the content of the h1 element with the fetched data
                $('#totalCitationCount').text(response);
                $('#totalCitationCount').removeClass(loadingSpinnerClass);
            },
            error: function(error) {
                console.error('Error fetching data:', error);
                $('#totalCitationCount').addClass(loadingSpinnerClass);
            }
        });

        // Ajax call to get total international journal count
        $('#totalInternationalJournal').addClass(loadingSpinnerClass);
        $.ajax({
            url: 'dashboard/getTotalInternationalPublication',
            method: 'GET',
            dataType: 'json',
            success: function(response) {
                // Update the content of the h1 element with the fetched data
                $('#totalInternationalJournal').text(response);
                $('#totalInternationalJournal').removeClass(loadingSpinnerClass);
            },
            error: function(error) {
                console.error('Error fetching data:', error);
                $('#totalInternationalJournal').addClass(loadingSpinnerClass);
            }
        });

        // Ajax call to get total international journal count
        $('#totalBook').addClass(loadingSpinnerClass);
        $.ajax({
            url: 'dashboard/getTotalBook',
            method: 'GET',
            dataType: 'json',
            success: function(response) {
                // Update the content of the h1 element with the fetched data
                $('#totalBook').text(response);
                $('#totalBook').removeClass(loadingSpinnerClass);
            },
            error: function(error) {
                console.error('Error fetching data:', error);
                $('#totalBook').addClass(loadingSpinnerClass);
            }
        });

        // Ajax call to get total issn journal
        $('#totalISSNJournal').addClass(loadingSpinnerClass);
        $.ajax({
            url: 'dashboard/getTotalISSNPublication',
            method: 'GET',
            dataType: 'json',
            success: function(response) {
                // Update the content of the h1 element with the fetched data
                $('#totalISSNJournal').text(response);
                $('#totalISSNJournal').removeClass(loadingSpinnerClass);
            },
            error: function(error) {
                console.error('Error fetching data:', error);
                $('#totalISSNJournal').addClass(loadingSpinnerClass);
            }
        });
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


<div class="container items-center px-4 py-8 m-auto mt-5 grid grid-cols-1 gap-8 lg:grid-cols-2">
    <div class="w-full px-5 lg:px-4">
        <canvas id="bar-chart-get-publication-count-gscholar"></canvas>
    </div>
    <div class="w-full px-5 lg:px-4">
        <canvas id="bar-chart-get-publication-count-scopus"></canvas>
    </div>
    <div class="w-full px-5 lg:px-4 ">
        <canvas id="bar-chart-get-publication-count-wos"></canvas>
    </div>
    <div class="w-full px-5 lg:px-4 ">
        <canvas id="bar-chart-get-top-ten-v3score"></canvas>
    </div>
</div>

<script>
    // Ajax call to get publication count last 5 years Google Scholar
    $.ajax({
        url: 'dashboard/getPublicationCountLast5YearsGscholar',
        method: 'GET',
        dataType: 'json',
        success: function(response) {
            const publish_year = response.map(data => data.publish_year);
            const publication_count = response.map(data => data.count);

            // Bar chart
            new Chart(document.getElementById("bar-chart-get-publication-count-gscholar"), {
                type: 'bar',
                data: {
                    labels: publish_year,
                    datasets: [{
                        label: "Jumlah Publikasi 5 Tahun Terakhir Google Scholar",
                        backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"],
                        data: publication_count
                    }]
                },
            });
        },
        error: function(error) {
            console.error('Error fetching data:', error);
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Failed to get publication count!',
            })
        }
    });

    // Ajax call to get publication count last 5 years Google Scopus
    $.ajax({
        url: 'dashboard/getPublicationCountLast5YearsScopus',
        method: 'GET',
        dataType: 'json',
        success: function(response) {
            const year = response.map(data => data.year);
            const count = response.map(data => data.count);

            // Bar chart
            new Chart(document.getElementById("bar-chart-get-publication-count-scopus"), {
                type: 'bar',
                data: {
                    labels: year,
                    datasets: [{
                        label: "Jumlah Publikasi 5 Tahun Terakhir Scopus",
                        backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"],
                        data: count
                    }]
                },
            });
        },
        error: function(error) {
            console.error('Error fetching data:', error);
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Failed to get publication count!',
            })
        }
    });

    // Ajax call to get publication count last 5 years Google Wos
    $.ajax({
        url: 'dashboard/getPublicationCountLast5YearsWos',
        method: 'GET',
        dataType: 'json',
        success: function(response) {
            const publish_year = response.map(data => data.publish_year);
            const publication_count = response.map(data => data.count);

            // Bar chart
            new Chart(document.getElementById("bar-chart-get-publication-count-wos"), {
                type: 'bar',
                data: {
                    labels: publish_year,
                    datasets: [{
                        label: "Jumlah Publikasi 5 Tahun Terakhir Web of Science",
                        backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"],
                        data: publication_count
                    }]
                },
            });
        },
        error: function(error) {
            console.error('Error fetching data:', error);
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Failed to get publication count!',
            })
        }
    });

    // Ajax call to get publication count last 5 years Google Wos
    $.ajax({
        url: 'dashboard/getTopTenSintaV3OverallScore',
        method: 'GET',
        dataType: 'json',
        success: function(response) {
            const lectureName = response.map(data => data.fullname);
            const sintaScore = response.map(data => data.sinta_score_v3_overall);
            // Bar chart
            new Chart(document.getElementById("bar-chart-get-top-ten-v3score"), {
                type: 'bar',
                data: {
                    labels: lectureName,
                    datasets: [{
                        label: "Top 10 Dosen Berdasarkan SINTA Overall V3 Score Tertinggi",
                        backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"],
                        data: sintaScore
                    }]
                },
                options: {
                    scales: {
                        x: {
                            ticks: {
                                maxTicksLimit: 10, // Batas jumlah tanda sumbu x yang ditampilkan
                                callback: function(value) {
                                    // truncate the labels only in this axis
                                    const lbl = this.getLabelForValue(value);
                                    if (typeof lbl === 'string' && lbl.length > 10) {
                                        return `${lbl.substring(0, 5)}...`;
                                    }
                                    return lbl;
                                },
                            },
                        },
                    },
                },
            });
        },
        error: function(error) {
            console.error('Error fetching data:', error);
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Failed to top 10 overall v3 score!',
            })
        }
    });
</script>